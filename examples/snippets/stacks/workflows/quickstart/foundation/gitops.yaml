
workflows:
  all:
    description: Run all Gitops workflows
    steps:
      - command: workflow vendor -f quickstart/foundation/gitops
      - command: workflow deploy -f quickstart/foundation/gitops

  vendor:
    description: Vendor Gitops required components.
    steps:
    - command: vendor pull --component github-oidc-provider
    - command: vendor pull --component iam-role
    - command: vendor pull --component dynamodb
    - command: vendor pull --component s3-bucket

  deploy:
    description: Run deployment for Gitops requirements
    steps:
      - command: terraform deploy github-oidc-provider -s core-use1-auto
      - command: terraform deploy gitops/s3-bucket --stack core-use1-auto
      - command: terraform deploy gitops/dynamodb --stack core-use1-auto
      - command: terraform deploy iam-role/gitops --stack core-use1-auto