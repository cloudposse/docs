---
title: "Setup Atmos Pro"
sidebar_label: "Setup"
sidebar_position: 1
---
import Intro from '@site/src/components/Intro';
import KeyPoints from '@site/src/components/KeyPoints';
import Steps from '@site/src/components/Steps';
import Step from '@site/src/components/Step';
import StepNumber from '@site/src/components/StepNumber';
import TaskList from '@site/src/components/TaskList';
import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';
import CodeBlock from '@theme/CodeBlock';
import PartialAtmosPro from '@site/examples/snippets/.github/workflows/atmos-pro.yaml';
import PartialAtmosProTerraformPlan from '@site/examples/snippets/.github/workflows/atmos-pro-terraform-plan.yaml';
import PartialAtmosProTerraformApply from '@site/examples/snippets/.github/workflows/atmos-pro-terraform-apply.yaml';

<Intro>
  Setting up Atmos Pro is straightforward: install the GitHub App, grant repository permissions, set up the workflows, and deploy the AWS infrastructure. This guide provides an overview of each step, with detailed instructions available in the linked pages.
</Intro>

## Setup Process

<Steps>
  <Step>
    ### <StepNumber/> Sign up for Atmos Pro

    The first step is to sign up for Atmos Pro. The sign up process includes creating a workspace in the Atmos Pro web console and installing the Atmos Pro GitHub App into your infrastructure repository. This will set up the connection between your repository and Atmos Pro.

    <TaskList>
      - Sign up for Atmos Pro
      - Create or join a workspace
      - Install the Atmos Pro GitHub App
      - Import your repositories
    </TaskList>

    For step-by-step instructions, see the [official Atmos Pro installation guide](https://atmos-pro.com/docs/install).
  </Step>

  <Step>
    ### <StepNumber/> Grant Repository Permissions

    The second step is to grant repository permissions in Atmos Pro to enable ordered deployments and other features.

    <TaskList>
      - Permission: `Affected Stacks Create`
      - Workflow: `*`
      - Branch: `*`
      - Environment: `*`
    </TaskList>

    For detailed instructions on repository permissions, see the [official Atmos Pro repository permissions guide](https://atmos-pro.com/docs/ordered-deployments/repository-permissions).
  </Step>

  <Step>
    ### <StepNumber/> Set Up Workflows

    The third step is to configure the workflows in your repository. This includes reviewing the generated workflows, setting up environment variables, and configuring branch protection rules.

    <TaskList>
      - Review the 3 GitHub Action workflows
      - Add the Workspace ID to GitHub repository variables
      - Merge the workflows into the default branch
    </TaskList>

    _The dispatched workflows need to exist in the default branch before they can be triggered!_

    The following workflows should be added to your repository:

    <Tabs>
      <TabItem value="atmos-pro" label="atmos-pro.yaml">
        This workflow is triggered by GitHub on pull request events (opened, synchronized, reopened) and when the PR is merged (closed). It uses the `atmos describe affected` command to identify affected components and upload them to Atmos Pro.

        <CodeBlock language="yaml" title=".github/workflows/atmos-pro.yaml">
          {PartialAtmosPro}
        </CodeBlock>
      </TabItem>
      <TabItem value="atmos-pro-terraform-plan" label="atmos-pro-terraform-plan.yaml">
        This workflow is dispatched by Atmos Pro to create Terraform plans for affected components. It is a reusable workflow that takes stack and component as inputs.

        <CodeBlock language="yaml" title=".github/workflows/atmos-pro-terraform-plan.yaml">
          {PartialAtmosProTerraformPlan}
        </CodeBlock>
      </TabItem>
      <TabItem value="atmos-pro-terraform-apply" label="atmos-pro-terraform-apply.yaml">
        This workflow is dispatched by Atmos Pro to apply Terraform changes for affected components. It is a reusable workflow that takes stack and component as inputs.

        <CodeBlock language="yaml" title=".github/workflows/atmos-pro-terraform-apply.yaml">
          {PartialAtmosProTerraformApply}
        </CodeBlock>
      </TabItem>
    </Tabs>

    For additional workflow setup instructions, see the [official Atmos Pro workflow configuration guide](https://atmos-pro.com/docs/ordered-deployments/github-workflow-config).
  </Step>

  <Step>
    ### <StepNumber/> Deploy AWS Infrastructure

    Atmos Pro doesn't run Terraform or Atmos itself. It dispatches GitHub Actions that **you control**. To run Terraform in those GitHub Actions, you need to set up a few things in your cloud environment:

    <TaskList>
    - [x] **State Backend** (S3 + DynamoDB) to store Terraform state and enable state locking
    - [ ] **Plan File Storage** (S3 + DynamoDB) to persist Terraform plan outputs for review and approvals
    - [ ] **OIDC Integration** with GitHub for workflows to authenticate with your cloud provider
    </TaskList>

    If you've been following along with the reference architecture, by now you should already have the Terraform State Backend provisioned. To complete the requirements for Atmos Pro and GitHub Actions, continue with the step-by-step instructions: 
    [Atmos and Terraform deployment](/layers/atmos-pro/setup/)
  </Step>
</Steps>

<KeyPoints title="Tips">
  1. Make sure you have admin access to both GitHub and AWS before starting the setup
  2. Follow the detailed instructions in each linked guide for specific steps
  3. Test the setup with a small change before deploying major infrastructure changes
</KeyPoints>

## Verification

After completing all four steps, you can verify the setup by:

<Steps>
  <Step>
    ### <StepNumber/> Test GitHub Integration

    - Create a new pull request with a small stack change
    - The Atmos Pro GitHub App will automatically comment on the PR
    - The comment will show the status of affected components
    - As workflows are dispatched for each component, the comment will automatically update
  </Step>

  <Step>
    ### <StepNumber/> Trigger a Plan

    - In the new pull request, change a value for any component. For example, add a tag to a S3 bucket.
    - The `atmos-pro.yaml` workflow will discover the newly affected stack and trigger Atmos Pro.
    - Atmos Pro will run Atmos Terraform Plan for the affected stack.
    - As the workflow is executed, Atmos Pro will update the comment on the PR with the plan status.
  </Step>

  <Step>
    ### <StepNumber/> Merge the PR

    - Now try merging the PR
    - Again, the `atmos-pro.yaml` workflow will discover the affected stacks and trigger Atmos Pro.
    - This time Atmos Pro will determine this is a "merged" event and run Atmos Terraform Apply.
    - Finally, Atmos Pro will update the comment on the PR will the apply status.
  </Step>

</Steps>
