---
title: "How to Log into AWS"
sidebar_label: "Login to AWS"
sidebar_position: 6
description: Use Atmos Auth to login to AWS
---
import Intro from '@site/src/components/Intro';
import Note from '@site/src/components/Note';
import Steps from '@site/src/components/Steps';

{/* TODO:DEPRECATE-ACCOUNT-MAP - REWRITE PAGE - Status: Done */}

<Intro>
Locally authenticating with Atmos Auth and AWS Identity Center (AWS SSO).
</Intro>

:::tip Leapp is Deprecated
Leapp is no longer used for authentication. If you see references to Leapp in older documentation, they are deprecated. We now use **Atmos Auth** for AWS authentication.
:::

## Requirements

Atmos Auth is built into the Atmos CLI, so no additional tools are required beyond what's already in the project.

## Setting Your Profile

Before authenticating, you need to set your profile to match your team role. Profiles are located in the `profiles/` directory:

<Steps>
  1. **`developers`** — For developers team members
  1. **`devops`** — For DevOps team members
  1. **`managers`** — For managers team members
</Steps>

### Setting the Profile

Set the `ATMOS_PROFILE` environment variable to your team's profile:

```bash
export ATMOS_PROFILE=developers  # or devops, managers
```

To make this persistent, add the export command to your shell configuration file:

<Steps>
  1. **zsh** — Add to `~/.zshrc`
  1. **bash** — Add to `~/.bashrc` or `~/.bash_profile`
  1. **fish** — Add to `~/.config/fish/config.fish` (use `set -gx ATMOS_PROFILE developers`)
</Steps>

After adding to your shell config, reload it:

```bash
source ~/.zshrc  # or source ~/.bashrc
```

<Note>
If you only run the export command without adding it to your config file, it will only apply to your current session.
</Note>

The profile determines which permissions and identities are available to you. Identities follow the format `<account>/<permission-set>` and include:

<Steps>
  1. **Terraform identities** — `plat-dev/terraform`, `core-identity/terraform` - Used automatically by Atmos for Terraform operations
  1. **Permission set identities** — `plat-dev/ReadOnlyAccess`, `plat-prod/AdministratorAccess` - Used for AWS CLI and console access
</Steps>

## Authentication

Authentication with Atmos Auth is simple and streamlined. The authentication configuration is already set up in `atmos.yaml` and your selected profile.

### Quick Login

To authenticate with AWS, run:

```bash
atmos auth login --provider sso
```

This will:

<Steps>
  1. **Use your configured profile** — Determine the appropriate identity
  1. **Open your browser** — Navigate to the AWS SSO login page
  1. **Authenticate with your IdP** — Sign in with your organization credentials
  1. **Store credentials securely** — Save to your system keychain
  1. **Set up AWS credentials** — Configure access to the infrastructure
</Steps>

No need to specify an identity - your profile handles that automatically!

### Check Authentication Status

To verify you're authenticated and see your current session details:

```bash
atmos auth whoami
```

This will show you:

<Steps>
  1. **Identity** — Which identity you're using
  1. **Account and role** — The AWS account and role
  1. **Expiration** — Credential expiration time
</Steps>

## Daily Workflow

Your typical workflow with Atmos is simple and straightforward.

### Using Atmos CLI (Recommended)

With Atmos Auth, you can run Atmos commands directly on your local machine. Once you've authenticated with `atmos auth login` and selected an identity, Atmos will automatically use your credentials and select the appropriate identity for each stack.

**Run Terraform commands:**

```bash
# Plan a terraform component
atmos terraform plan vpc -s plat-ue1-dev

# Apply a terraform component
atmos terraform apply vpc -s plat-ue1-dev
```

**Launch AWS Console in browser:**

```bash
atmos auth console --identity plat-dev/ReadOnlyAccess
```

**Run a specific AWS CLI command:**

```bash
# Execute a single AWS CLI command with read-only access
atmos auth exec --identity plat-dev/ReadOnlyAccess -- aws sts get-caller-identity

# List S3 buckets in production with admin access
atmos auth exec --identity plat-prod/AdministratorAccess -- aws s3 ls
```

**Start an interactive shell with a specific identity:**

```bash
# Open a shell session for running multiple commands
atmos auth shell --identity core-security/PowerUserAccess

# Exit the shell with Ctrl+D or type 'exit'
```

**List all available identities:**

```bash
atmos auth list
```

:::tip
Atmos will automatically select the correct identity for the stack you're working with. You can override this with the `--identity` flag if needed.
:::

### Using Geodesic (Optional)

If you prefer a containerized development environment with all tools pre-configured, you can use Geodesic:

**First time setup:**

```bash
make all
```

**Subsequent launches:**

```bash
make run
```

**When to use Geodesic:**

<Steps>
  1. **Containerized environment** — You prefer a containerized development environment
  1. **Pre-configured tools** — You want all tools pre-configured without managing versions locally
  1. **Persistent shell** — You're working on multiple components and want a persistent shell session
  1. **Multiple projects** — You're working across multiple projects with different tool requirements
  1. **Kubernetes access** — You need to set up Kubernetes access with the `set-cluster` script
</Steps>

**When to use direct Atmos:**

<Steps>
  1. **Quick commands** — You're running quick one-off commands
  1. **Local integration** — You want to integrate Atmos into your local scripts or workflows
  1. **Local machine** — You prefer working directly on your local machine
</Steps>

Both approaches work seamlessly with Atmos Auth!

## Troubleshooting

### Error: invalid identity kind / unsupported identity kind

This error occurs when the `ATMOS_PROFILE` environment variable is not set:

```
Error: invalid identity kind
unsupported identity kind:
```

**Fix:** Set your profile:

```bash
export ATMOS_PROFILE=developers  # or devops, managers
```

To make the profile persistent, add `export ATMOS_PROFILE=<your-profile>` to your shell configuration file (`~/.zshrc` or `~/.bashrc`).

### Cannot connect to cluster

<Steps>
  1. **VPN connection** — Verify VPN connection is active
  1. **Correct identity** — Check that you're using the correct identity for the account
  1. **Cluster name** — Ensure the cluster name matches the expected format
</Steps>

### Permission denied errors

<Steps>
  1. **Account identity** — Confirm you're using the correct account identity for the account
  1. **Profile permissions** — Verify your profile has the appropriate permissions for that account
  1. **Identity configuration** — Check that the identity has been properly configured in your profile
</Steps>

### Terraform commands fail

<Steps>
  1. **Account identities** — Account identities don't provide Terraform access - they're for EKS/AWS CLI only
  1. **Exit shell** — Exit any account identity shell and use the default identity from your profile
  1. **Profile setting** — Ensure your profile is set correctly with `ATMOS_PROFILE`
</Steps>

## Additional Information

For more details about Atmos Auth, including advanced features like identity chaining, multiple identities, and troubleshooting, see the [Atmos Auth documentation](https://atmos.tools/cli/commands/auth/usage/#overview).
