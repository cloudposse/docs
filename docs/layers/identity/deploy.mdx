---
title: "Deploy IAM Roles"
sidebar_label: "Deploy IAM Roles"
sidebar_position: 4
description: Deploy IAM roles for GitHub Actions and machine users using the iam-role component.
---
import Intro from '@site/src/components/Intro';
import KeyPoints from '@site/src/components/KeyPoints';
import Steps from '@site/src/components/Steps';
import Step from '@site/src/components/Step';
import StepNumber from '@site/src/components/StepNumber';
import Note from '@site/src/components/Note';
import AtmosWorkflow from '@site/src/components/AtmosWorkflow';
import ActionCard from '@site/src/components/ActionCard';
import PrimaryCTA from '@site/src/components/PrimaryCTA';

{/* TODO:DEPRECATE-ACCOUNT-MAP - UPDATE PAGE - Status: Done */}

<Intro>
Deploy IAM roles for GitHub Actions and machine users using the `iam-role` component. These roles are assumed via OIDC for CI/CD automation.
</Intro>

<Note title="Legacy Approach">
The legacy `aws-teams` and `aws-team-roles` components are deprecated. This page documents the new approach using Permission Sets for human users and IAM roles for machine users.

For the legacy approach, see [Access Control Evolution](/layers/identity/tutorials/access-control-evolution/).
</Note>

## Overview

The identity layer provides two authentication paths:

<Steps>
  1. **Human Users** — Use AWS IAM Identity Center Permission Sets (TerraformApplyAccess, TerraformPlanAccess) via SSO
  1. **Machine Users** — Use IAM roles assumed via OIDC (GitHub Actions, CI/CD pipelines)
</Steps>

Human users authenticate through Identity Center and never need IAM roles. The `iam-role` component is specifically for GitHub Actions and other machine users that authenticate via OIDC.

## Deploy IAM Roles for GitHub Actions

<Steps>
  <Step>
    ### <StepNumber/> Vendor Identity Components

    Pull the identity components into your local repository:

    <AtmosWorkflow workflow="vendor" fileName="quickstart/foundation/identity" />
  </Step>

  <Step>
    ### <StepNumber/> Deploy GitHub OIDC Provider

    Deploy the GitHub OIDC provider in all accounts:

    <AtmosWorkflow workflow="deploy/github-oidc-provider" fileName="quickstart/foundation/github" />

    This creates the OIDC identity provider in each account, allowing GitHub Actions to assume IAM roles.
  </Step>

  <Step>
    ### <StepNumber/> Deploy IAM Roles

    The reference architecture includes pre-configured `iam-role/terraform` and `iam-role/planner` components. Deploy them across all accounts:

    <AtmosWorkflow workflow="deploy/iam-role" fileName="quickstart/foundation/identity" />

    This deploys:

    <Steps>
      1. **`iam-role/terraform`** — Role for GitHub Actions apply operations
      1. **`iam-role/planner`** — Role for GitHub Actions plan operations
      1. **Trust policies** — Allow assumption via GitHub OIDC
    </Steps>
  </Step>
</Steps>

## Human User Access

Human users do **not** use IAM roles. Instead, they authenticate via AWS IAM Identity Center:

<Steps>
  1. **Permission Sets** — Define access levels (TerraformApplyAccess, TerraformPlanAccess, ReadOnlyAccess)
  1. **SSO Groups** — Map IdP groups to Permission Sets
  1. **Atmos Auth** — CLI tool that authenticates via Identity Center SSO
</Steps>

See [Configure Atmos Auth](/layers/identity/atmos-auth/) for human user setup.

## Next Steps

<ActionCard title="Configure authentication">
  With IAM roles deployed for machine users and Permission Sets available for human users, configure Atmos Auth profiles to map users to identities.
  <PrimaryCTA to="/layers/identity/atmos-auth/">Configure Atmos Auth</PrimaryCTA>
</ActionCard>
